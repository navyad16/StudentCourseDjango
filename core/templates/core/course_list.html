{% extends 'core/base.html' %}
{% block content %}

<h3 class="mb-3">Available Courses</h3>

<form method="GET" class="row mb-4">
  <div class="col-md-5">
    <input name="q" value="{{ query|default:'' }}" class="form-control" placeholder="Search courses">
  </div>

  <div class="col-md-4">
    <select name="category" class="form-control">
      <option value="">All Categories</option>
      {% for c in categories %}
        <option value="{{ c.id }}"
          {% if selected_category == c.id|stringformat:"s" %}selected{% endif %}>
          {{ c.name }}
        </option>
      {% endfor %}
    </select>
  </div>

  <div class="col-md-3">
    <button class="btn btn-primary w-100">Filter</button>
  </div>
</form>

<div class="row">
{% for course in courses %}
  <div class="col-md-4 mb-4">
    <div class="card h-100 shadow-sm">

      {% if course.image %}
        <img src="{{ course.image.url }}" class="card-img-top" style="height:200px;object-fit:cover;">
      {% endif %}

      <div class="card-body">
        <h5>{{ course.title }}</h5>

        <p>{{ course.description|truncatewords:15 }}</p>
        <p><strong>â‚¹{{ course.price }}</strong></p>

        {% if user.is_authenticated %}
          <a href="/add-to-cart/{{ course.id }}/" class="btn btn-success w-100">Enroll</a>
        {% else %}
          <a href="/login/" class="btn btn-secondary w-100">Login to Enroll</a>
        {% endif %}
      </div>
    </div>
  </div>
{% empty %}
  <p>No courses found.</p>
{% endfor %}
</div>

{% endblock %}
